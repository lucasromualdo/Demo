function isEmailValido(e){return regexEmail.test(e)}function isCPFValido(e){var a,o;a=0;for(var i=0;i<10;++i)if(new RegExp("/^"+i+"{11}$/").test(e))return!1;for(i=1;i<=9;i++)a+=parseInt(e.substring(i-1,i))*(11-i);if(o=10*a%11,10!=o&&11!=o||(o=0),o!=parseInt(e.substring(9,10)))return!1;for(a=0,i=1;i<=10;i++)a+=parseInt(e.substring(i-1,i))*(12-i);return o=10*a%11,10!=o&&11!=o||(o=0),o==parseInt(e.substring(10,11))}function isDataValida(e){var a=/^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-.\/])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$/;return a.test(e)}function onKeyupUsuarioCliente(e){var a=$("#usuario-cliente").val(),o=a.replace(regexCaracteresInvalidosCarteiraEmail,"");0==o.length||isNaN(o)?$("#campo-data-nascimento-cliente").hide():$("#campo-data-nascimento-cliente").show()}function getLoginUsuarioCooperado(e){var a=e;if(!isNaN(e)&&e.length>0&e.length<=5){var o=e;for(i=0;i<5-e.length;i++)o="0"+o;var n=calcularDigito(o);a="adm00611"+o+n}return a}function calcularDigito(e){var a;11==e.length?(a=6*e.substring(5,6),a+=5*e.substring(6,7),a+=4*e.substring(7,8),a+=3*e.substring(8,9),a+=2*e.substring(9,10)):(a=6*e.substring(0,1),a+=5*e.substring(1,2),a+=4*e.substring(2,3),a+=3*e.substring(3,4),a+=2*e.substring(4,5));var o=a%11;return o>9&&(o=0),o}function redirectToCustomLoginPageOrLoadPage(e){var a=/goto=([^&]+)/i.exec(window.location.search+window.location.hash),o=getCookie("Origin");if(a){var i=decodeURIComponent(a[1]);if(i.match(/\/(espacoempresa|movespacoempresa)/)&&"/acesso/loginEmpresa.html"!=window.location.pathname)return void(window.location="./loginEmpresa.html?autologin=off&"+a[0]);if(i.match(/\/(espacocliente)/)&&"/acesso/loginCliente.html"!=window.location.pathname)return void(window.location="./loginCliente.html?autologin=off&"+a[0]);if(i.match(/\/(consultorio|cooperado)/)&&"/acesso/loginCooperado.html"!=window.location.pathname)return void(window.location="./loginCooperado.html?"+a[0]);if(i.match(".unimedbh.com.br:443/guia")&&"/acesso/loginCooperado.html"!=window.location.pathname)return void(window.location="./loginCooperado.html?"+a[0]);if(i.match(/\/(ecommerce)/)&&"/acesso/loginEcommerce.html"!=window.location.pathname)return void(window.location="./loginEcommerce.html?autologin=off&"+a[0]);if(i.match(/(www.mediacentersambatech.com.br|sessoesclinicas)/)&&"/acesso/loginCooperado.html"!=window.location.pathname)return void(window.location=window.location.href.replace("login.html","loginCooperado.html"));if(i.match(/(lmssambatech.com.br)/)&&"/acesso/loginAprendizado.html"!=window.location.pathname)return void(window.location=window.location.href.replace("login.html","loginAprendizado.html"));if(i.match(/\/(novaintranet)/))defineMensagem("sucesso","Digite seu usuario e senha de rede.");else{if(o.toLowerCase().match(/(portalprestador)/)&&"/acesso/loginPrestador.html"!=window.location.pathname)return document.cookie="Origin=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",void(window.location="./loginPrestador.html?"+a[0]);if(o.toLowerCase().match(/(hotsite)/)&&"/acesso/loginCooperado.html"!=window.location.pathname)return document.cookie="Origin=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",void(window.location="./loginCooperado.html?"+a[0]);if(i.match(/(consol3)/)&&"/acesso/loginSol.html"!=window.location.pathname)return void(window.location="./loginSol.html?"+a[0])}}e&&e()}function getCookie(e){for(var a=e+"=",o=document.cookie.split(";"),i=0;i<o.length;++i){var n=o[i].replace(/\s*/g,"");if(0==n.indexOf(a))return n.substring(a.length,n.length)}return""}function clearCookies(){document.cookie="iPlanetDirectoryPro=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="DT_USR=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="LtpaToken=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="LtpaToken2=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="JSESSIONID=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="JSESSIONIDSSO=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="AMAuthCookie=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="AMAuthCookieAWS=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="Origin=; Domain=.unimedbh.com.br; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"}function destroySession(e){window.iniciouLogin=!1,e||(e=baseURL+"/acesso/login.html?autologin=off");var a='{ "stage": "ldapService" }',o=function(){clearCookies(),setTimeout(function(){window.location=e},1e3)},i=getCookie("iPlanetDirectoryPro");i?$.ajax({type:"POST",url:baseURLOpenAM+"/json/sessions/"+i+"?_action=validate",contentType:"application/json",data:a}).done(function(n){n.valid?$.ajax({type:"POST",url:baseURLOpenAM+"/json/sessions/"+i+"?_action=logout",contentType:"application/json",data:a}).done(function(e){o()}):window.location=e}):o()}function cancelaLoginUsuario(){ativarPainel(3),$("#usuario-cliente").focus()}function recuperaLoginUsuario(){var e=$("#usuario-cliente").val(),a=$("#data-nascimento-cliente").val();"Entrar"!=$("#Proximo").text()?"Cadastrar"!=$("#Proximo").text()?0!=e.length&&"E-mail ou número do cartão"!==e?regexCaracteresInvalidosCarteiraEmail.test(e)?defineMensagem("erro","O email ou carteira informado possui caracteres inválidos."):(startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/RecuperarLoginUsuario",dataType:"json",cache:!1,data:{usuario:e,dataNascimento:a},async:!0,timeout:6e4}).done(function(a){if(stopLoading(),a.sucesso)"MSG_USUARIO_ENCONTRADO_UNIMEDBH"==a.mensagem&&(defineMensagem("sucesso","Encontramos seu usuário no sistema. Informe abaixo a sua senha."),$("#usuario-cliente").addClass("desabilita-campo"),$("#usuario-cliente").attr("readonly","true"),$("#data-nascimento-cliente").addClass("desabilita-campo"),$("#data-nascimento-cliente").attr("readonly","true"),$("#campo-senha-cliente").show(),$("#email-cliente").val(a.data.uid),$("#id-pessoa-cliente").val(a.data.idPessoa),$("#email-cliente").addClass("desabilita-campo"),$("#email-cliente").attr("readonly","true"),isNaN(e)?($("#campo-email-cliente").hide(),$("#campo-confirmar-email-cliente").hide()):($("#campo-email-cliente").show(),$("#campo-confirmar-email-cliente").hide()),$("#Proximo").text("Entrar"),$("#Voltar").parent().show(),$("#link-lembrar-senha").show(),$("#link-trocar-email").show(),$("#senha-cliente").focus());else{$("#link-lembrar-senha").hide(),$("#link-trocar-email").hide(),a.data&&a.data.idPessoa?$("#id-pessoa-cliente").val(a.data.idPessoa):$("#id-pessoa-cliente").val("");var o=a.mensagem;switch(o){case"MSG_CARTEIRA_NAO_ENCONTRADA":o="Número do cartão não encontrado no sistema.",$("#usuario-cliente").focus();break;case"MSG_DATA_NASCIMENTO_INCORRETA":o="Data de nascimento incorreta.",$("#data-nascimento-cliente").focus();break;case"MSG_USUARIO_NAO_ENCONTRADO":isNaN(e)?(o="Não identificamos seu cadastro no sistema. Por favor, informe abaixo seus dados abaixo para prosseguir.",isEmailValido(e)&&$("#email-cliente").val(e),$("#usuario-cliente").val(""),$("#campo-data-nascimento-cliente").show(),$("#usuario-cliente").focus()):(o="Não identificamos seu cadastro no sistema. Por favor, preencha os dados abaixo para realizar o cadastro.",$("#usuario-cliente").addClass("desabilita-campo"),$("#usuario-cliente").attr("readonly","true"),$("#data-nascimento-cliente").addClass("desabilita-campo"),$("#data-nascimento-cliente").attr("readonly","true"),$("#email-cliente").removeClass("desabilita-campo"),$("#email-cliente").removeAttr("readonly"),$("#campo-email-cliente").show(),$("#campo-confirmar-email-cliente").show(),$("#campo-senha-cliente").show(),$("#campo-confirmar-senha-cliente").show(),$("#Proximo").text("Cadastrar"),$("#Voltar").parent().show(),$("#email-cliente").focus())}defineMensagem("erro",o)}}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})):defineMensagem("erro","Informe o e-mail ou número do cartão."):criarContaUsuarioCliente():setTimeout(function(){defineMensagem("sucesso","Autenticando..."),$("#usuario").val($("#email-cliente").val()),$("#senha").val($("#senha-cliente").val()),solicitaLogin()},3e3)}function solicitaLoginCooperado(){solicitaLogin(getLoginCooperado)}function solicitaLogin(e){if(!window.iniciouLogin){window.iniciouLogin=!0,e||(e=function(){return $("#usuario").val()});var a=e();if(0==a.length||"Usuário"===a)return defineMensagem("erro","Informe o usuário"),void(window.iniciouLogin=!1);if(regexCaracteresInvalidosCarteiraEmail.test(a))return defineMensagem("erro","O usuário informado possui caracteres inválidos."),void(window.iniciouLogin=!1);if(0==$("#senha").val().length||"Senha"===$("#senha").val())return defineMensagem("erro","Informe a senha"),void(window.iniciouLogin=!1);var o=$("#senha").val();defineMensagem(),startLoading();var i='{ "stage": "ldapService" }';setTimeout(function(){$.ajax({type:"POST",url:baseURLOpenAM+"/json/authenticate",cache:!1,headers:{"X-OpenAM-Username":a,"X-OpenAM-Password":o,"Content-type":"application/json"},data:i,async:!0}).done(function(e){window.iniciouLogin=!1,e.tokenId?(document.cookie="iPlanetDirectoryPro="+e.tokenId+"; Domain=.unimedbh.com.br; Path=/;",document.cookie='DT_USR="'+a+'"; Domain=.unimedbh.com.br; Path=/;',window.location=window.location):defineMensagem("erro","Usuario e/ou senha invalido(s)"),stopLoading()}).fail(function(e,a,o){window.iniciouLogin=!1;e.status;e.responseText.match(/Account Expired/i)?defineMensagem("erro","Sua conta expirou!"):e.responseText.match(/User Account Locked/i)?defineMensagem("erro","Sua conta está bloqueada!"):e.responseText.match(/Invalid Password|Authentication Failed/i)?defineMensagem("erro","Usuario e/ou senha invalido(s)"):defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})},500)}}function sair(){startLoading();var e=window.location.href;e.match(/autologin=off/)||(e=window.location.search.length>0?window.location.href+"&autologin=off":window.location.href+"?autologin=off"),destroySession(e),stopLoading()}function exibirPainelTrocaEmail(){startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/RecuperarDadosUsuarioCliente",dataType:"json",cache:!1,data:{idPessoa:$("#id-pessoa-cliente").val()},async:!0,timeout:3e4}).done(function(e){if(e.sucesso){var a=$("#email-cliente").val();$("#usuario-atual").val(a),e.data.emailCadastro&&a!=e.data.emailCadastro?($("#novo-usuario").val(e.data.emailCadastro),$("#novo-usuario").addClass("desabilita-campo"),$("#novo-usuario").attr("readonly","true"),$("#confirmacao-novo-usuario").val(e.data.emailCadastro),ativarPainel(15),defineMensagem("sucesso","Abaixo está o e-mail mais recente preenchido em seu cadastro na Unimed-BH. Para alterar seu usuário usando a conta abaixo, solicite o envio do link."),e.data.celularCadastro&&($("#link-trocar-email-celular").show(),$("#numero-celular").val(e.data.celularCadastro),$("#numero-celular").mask("(99) 99999-9999"))):e.data.celularCadastro?($("#numero-celular").val(e.data.celularCadastro),$("#numero-celular").mask("(99) 99999-9999"),exibirPainelTrocaEmailCelular()):defineMensagem("erro","Não encontramos um telefone celular em seu cadastro. Entre em contato com a Unimed-BH pelo 0800 030 30 03 e solicite a troca de e-mail.")}stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}function exibirPainelTrocaEmailCelular(){ativarPainel(16),defineMensagem("sucesso","Solicite o código de segurança em seu celular para ativar a opção de alterar login. Confirme seu número e caso esteja incorreto entre em contato com a Unimed-BH pelo 0800 030 03 para atualizar o cadastro.")}function solicitarEnvioCodigoSegurancaSMS(){startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/SolicitarEnvioCodigoSeguranca",dataType:"json",cache:!1,data:{usuario:$("#email-cliente").val()},async:!0,timeout:6e4}).done(function(e){if(e.sucesso)"MSG_SMS_ENVIADO"==e.mensagem&&($("#campo-codigo-seguranca").show(),$("#botao-verificar-codigo").show(),$("#botao-solicitar-codigo").hide(),operacaoAtual=validarCodigoSeguranca);else{var a=e.mensagem;switch(a){case"MSG_USUARIO_NAO_INFORMADO":a="Usuário não informado."}defineMensagem("erro",a)}stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}function validarCodigoSeguranca(){startLoading();$.ajax({type:"POST",url:baseURL+"/cgi-bin/ValidarCodigoSeguranca",dataType:"json",cache:!1,data:{usuario:$("#email-cliente").val(),codigoSeguranca:$("#codigo-seguranca").val()},async:!0,timeout:6e4}).done(function(e){if(e.sucesso)"MSG_CODIGO_SEGURANCA_OK"==e.mensagem&&ativarPainel(17);else{var a=e.mensagem;switch(a){case"MSG_USUARIO_NAO_INFORMADO":a="Usuário não informado.";break;case"MSG_CODIGO_SEGURANCA_NAO_INFORMADO":a="Código de segurança não informado.";break;case"MSG_CODIGO_SEGURANCA_INCORRETO":a="Código de segurança incorreto."}defineMensagem("erro",a)}stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}function lembrarSenha(e,a){startLoading(),e||(e=getUsuarioSolicitante),a||(a=getEmailSolicitante);var o=e(),i=a();$.ajax({type:"POST",url:baseURL+"/cgi-bin/SolicitarTrocaSenha",cache:!1,data:{username:o,email:i||o},async:!0,timeout:3e4}).done(function(e){var a=e.replace(/[\n\r]/g,"").replace(/^.+mensagem=/,""),o="erro";e.match(/sucesso=true/)&&(o="sucesso",$("#campos-form-lembrar-senha").hide(),$("#campos-form-login-cliente").hide()),defineMensagem(o,a),stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}function trocarSenha(){if(changePasswordCode||!($("#senha-atual").val().length<3||"Senha"===$("#senha-atual").val()))if($("#nova-senha").val().length<3||"Nova senha"===$("#nova-senha").val())defineMensagem("erro","A nova senha é inválida");else if($("#nova-senha").val()==$("#confirmacao-nova-senha").val()&&"Confirmação nova senha"!==$("#confirmacao-nova-senha").val()){defineMensagem();var e={newPassword:$("#nova-senha").val(),newPasswordConfirmation:$("#confirmacao-nova-senha").val()};changePasswordCode?e.code=changePasswordCode:e.currentPassword=$("#senha-atual").val(),startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/TrocarSenha",cache:!1,data:e,async:!0,timeout:3e4}).done(function(e){var a=e.replace(/[\n\r]/g,"").replace(/^.+mensagem=/,""),o="erro";e.match(/sucesso=true/)&&(o="sucesso",$("#campos-form-lembrar-senha").hide(),$("#campos-form-trocar-senha").hide()),defineMensagem(o,a),stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}else defineMensagem("erro","A nova senha é diferente da confirmação");else defineMensagem("erro","Senha atual inválida")}function alterarLogin(){if($("#novo-usuario").val()==$("#confirmacao-novo-usuario").val()){defineMensagem();var e={usuarioAtual:$("#usuario-atual").val(),codigoSeguranca:$("#codigo-seguranca").val(),novoUsuario:$("#novo-usuario").val(),confirmacaoNovoUsuario:$("#confirmacao-novo-usuario").val()};startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/AlterarLogin",cache:!1,data:e,async:!0,timeout:6e4}).done(function(e){var a=e.replace(/[\n\r]/g,"").replace(/^.+mensagem=/,""),o="erro";e.match(/sucesso=true/)&&(o="sucesso"),defineMensagem(o,a),stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}else defineMensagem("erro","O novo usuário é diferente da confirmação")}function criarContaUsuarioCliente(){var e=$("#termo-responsabilidade-aceito").val();if(isEmailValido($("#email-cliente").val()))if($("#email-cliente").val()==$("#confirmar-email-cliente").val())if($("#senha-cliente").val().length<3)defineMensagem("erro","Por favor, informe uma senha válida!");else if($("#senha-cliente").val()==$("#confirmar-senha-cliente").val())if(e&&"true"!=e)defineMensagem("erro","Você precisa ler e aceitar o 'TERMO DE RESPONSABILIDADE' no final deste formulário");else if(isDataValida($("#data-nascimento-cliente").val())){defineMensagem();var a="";if($("#data-nascimento-cliente").val().indexOf("-")>-1){var o=$("#data-nascimento-cliente").val().split("-");o.reverse(),o[0].indexOf("0")<0&&parseInt(o[0])<10&&(o[0]="0"+o[0]),o[1].indexOf("0")<0&&parseInt(o[1])<10&&(o[1]="0"+o[1]),a=o.join("/")}else $("#data-nascimento-cliente").val().indexOf("/")>-1&&(a=$("#data-nascimento-cliente").val());startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/CadastrarUsuarioCliente",dataType:"json",data:"idPessoa="+$("#id-pessoa-cliente").val()+"&numeroCarteira="+$("#usuario-cliente").val()+"&dataNascimento="+a+"&email="+$("#email-cliente").val()+"&senha="+$("#senha-cliente").val(),cache:!1,async:!0,timeout:3e4}).done(function(e){if(stopLoading(),e.sucesso)defineMensagem("sucesso","Usuário cadastrado com sucesso no sistema."),$("#Proximo").text("Entrar"),recuperaLoginUsuario();else{var a=e.mensagem;switch(a){case"MSG_DATA_NASCIMENTO_INVALIDA":a="Data de nascimento inválida.";break;case"MSG_CARTEIRA_INVALIDA":a="Número do cartão inválido.";break;case"MSG_CARTEIRA_NAO_ATIVA":a="Número do cartão não está ativo.";break;case"MSG_DATA_NASCIMENTO_INCORRETA":a="Data de nascimento incorreta não confere com o cadastro.";break;case"MSG_CARTEIRA_OU_DATA_NASCIMENTO_INCORRETA":a="Núemro do cartão ou data de nascimento não estao corretos.";break;case"MSG_USUARIO_JA_CADASTRADO":a="Usuário já cadastrado no sistema.";break;case"MSG_ERRO_INESPERADO":a="Ocorreu um erro inesperado no sistema."}defineMensagem("erro",a)}}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}else defineMensagem("erro","Por favor, informe uma data de nascimento válida!");else defineMensagem("erro","A senha é diferente da confirmação.");else defineMensagem("erro","O e-mail de confirmação é diferente do e-mail.");else defineMensagem("erro","Por favor, informe um email válido!")}function criarConta(){var e=$("#termo-responsabilidade-aceito").val();if(isEmailValido($("#email").val()))if($("#criar-senha").val().length<3)defineMensagem("erro","Por favor, informe uma senha válida!");else if($("#criar-senha").val()==$("#confirmacao-criar-senha").val())if(e&&"true"!=e)defineMensagem("erro","Você precisa ler e aceitar o 'TERMO DE RESPONSABILIDADE' no final deste formulário");else{defineMensagem();var a="";if($("#data-nascimento").val().indexOf("-")>-1){var o=$("#data-nascimento").val().split("-");o.reverse(),o[0].indexOf("0")<0&&parseInt(o[0])<10&&(o[0]="0"+o[0]),o[1].indexOf("0")<0&&parseInt(o[1])<10&&(o[1]="0"+o[1]),a=o.join("/")}else $("#data-nascimento").val().indexOf("/")>-1&&(a=$("#data-nascimento").val());startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/CadastrarUsuario",data:"idPessoa="+$("#id-pessoa").val()+"&numeroCarteira="+$("#numero-carteira").val()+"&dataNascimento="+a+"&email="+$("#email").val()+"&senha="+$("#criar-senha").val()+"&confirmacaoNovoCadastro="+$("#confirmacao-novo-cadastro").val(),cache:!1,async:!0,timeout:3e4}).done(function(e){var a=e.replace(/[\n\r]/g,"").replace(/^.+mensagem=/,""),o="erro";e.match(/sucesso=true/)&&(o="sucesso",$("#campos-form-criar-contaC").hide()),defineMensagem(o,a),"sucesso"==o&&($("#usuario").val($("#email").val()),$("#senha").val($("#criar-senha").val()),setTimeout(function(){stopLoading(),solicitaLogin(),startLoading()},3e3)),stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})}else defineMensagem("erro","A nova senha é diferente da confirmação");else defineMensagem("erro","Por favor, informe um email válido!")}function pesquisarBeneficiario(){if(17==$("#numero-carteira").val().replace(/\D*/gi,"").length)if(isDataValida($("#data-nascimento").val())){var e="";if($("#data-nascimento").val().indexOf("-")>-1){var a=$("#data-nascimento").val().split("-");a.reverse(),a[0].indexOf("0")<0&&parseInt(a[0])<10&&(a[0]="0"+a[0]),a[1].indexOf("0")<0&&parseInt(a[1])<10&&(a[1]="0"+a[1]),e=a.join("/")}else $("#data-nascimento").val().indexOf("/")>-1&&(e=$("#data-nascimento").val());8==e.replace(/\D*/gi,"").length?(defineMensagem(),startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/RecuperarDadosBeneficiario",data:"numeroCarteira="+$("#numero-carteira").val()+"&dataNascimento="+e,dataType:"html",cache:!1,async:!0,timeout:3e4}).done(function(e){recuperouBeneficiario=!0;var a=e.replace(/[\n\r]/g,"").replace(/^.+mensagem=/,""),o="erro";if(e.match(/sucesso\":\"true/)){var i=$.parseJSON(e);$("#id-pessoa").val(i.idPessoa),$("#nome").val(i.nome),"null"==i.emailAOL?($("#email").val(i.email),$("#email").addClass("required"),$("#email").removeClass("desabilita-campo"),$("#email").removeAttr("readonly")):($("#email").val(i.emailAOL),$("#email").removeClass("required"),$("#email").addClass("desabilita-campo"),$("#email").attr("readonly","true")),ativarPainel(9)}else defineMensagem(o,a);stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})):defineMensagem("erro","Por favor, informe uma data de nascimento válida!")}else defineMensagem("erro","Por favor, informe uma data de nascimento válida!");else defineMensagem("erro","Por favor, informe um cartão válido!")}function pesquisarColaborador(){0!=$("#matricula").val().length?(defineMensagem(),startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/ValidarLogin",data:"matricula="+$("#matricula").val(),dataType:"json",cache:!1,async:!0,timeout:3e4}).done(function(e){"true"==e.sucesso?($("#nome-colaborador").val(e.nome[0]),ativarPainel(10)):defineMensagem("erro",e.mensagem),stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})):defineMensagem("erro","Informe a matrícula do colaborador UNIMED-BH, responsável pelo seu cadastro.")}function solicitarCadastroVisitante(){0!=$("#nome-visitante").val().length?isCPFValido($("#cpf-visitante").val().replace(/[\.\-]/g,""))?isEmailValido($("#email-visitante").val())?$("#criar-senha-visitante").val().length<3?defineMensagem("erro","Por favor, informe uma senha válida!"):$("#criar-senha-visitante").val()==$("#confirmacao-criar-senha-visitante").val()?"true"==$("#termo-responsabilidade-aceito").val()?(defineMensagem(),startLoading(),$.ajax({type:"POST",url:baseURL+"/cgi-bin/SolicitarAcessoVisitante",data:"matricula="+$("#matricula").val()+"&nome-visitante="+$("#nome-visitante").val()+"&cpf-visitante="+$("#cpf-visitante").val()+"&email-visitante="+$("#email-visitante").val()+"&senha-visitante="+$("#criar-senha-visitante").val()+"&confirmacao-senha-visitante="+$("#confirmacao-criar-senha-visitante").val(),dataType:"json",cache:!1,async:!0,timeout:3e4}).done(function(e){"true"==e.sucesso?($("#campos-form-criar-contaD").hide(),defineMensagem("sucesso",e.mensagem)):defineMensagem("erro",e.mensagem),stopLoading()}).fail(function(e,a,o){defineMensagem("erro","Ocorreu um erro no sistema. Por favor entre em contato com o administrador!"),stopLoading()})):defineMensagem("erro","Você precisa ler e aceitar o 'TERMO DE RESPONSABILIDADE' no final deste formulário"):defineMensagem("erro","A nova senha é diferente da confirmação"):defineMensagem("erro","Por favor, informe um email válido!"):defineMensagem("erro","Favor informar o CPF (válido) do visitante"):defineMensagem("erro","Favor informar o nome completo do visitante")}function geraCookieStickSession(){if(!window.location.search.match(/autologin=off/)){var e=getCookie("iPlanetDirectoryPro");$.ajax({type:"GET",url:baseURLOpenAM+"/UI/Login",async:!1,timeout:3e4});var a=getCookie("iPlanetDirectoryPro");e.length>0&&0==a.length&&$.ajax({type:"GET",url:baseURLOpenAM+"/UI/Login",async:!1,timeout:3e4})}}function verificaUsuarioAutenticado(e){var a=getCookie("iPlanetDirectoryPro");autenticado=!1;var o='{ "stage": "ldapService" }';a.length>0?$.ajax({url:baseURLOpenAM+"/json/sessions?_action=validate",type:"POST",contentType:"application/json",data:o,headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},async:!0,timeout:3e4}).done(function(a){a.valid&&(autenticado=!0),e(autenticado)}).fail(function(a,o,i){a.status;e(autenticado)}):e(autenticado)}function chamaVerificaUsuarioAutenticado(){verificaUsuarioAutenticado(retornoVerificaUsuarioAutenticado)}function retornoVerificaUsuarioAutenticado(e){changePasswordCode=/code=([^&]+)/i.exec(window.location.search),changePasswordCode&&(changePasswordCode=changePasswordCode[1]),e?_retornoVerificaUsuarioAutenticado(changePasswordCode):ativarPainel(changePasswordCode?5:3),stopLoading()}function _retornoVerificaUsuarioAutenticado(e){e&&sair(),ativarPainel(4);var a=window.location.search+window.location.hash,o=/goto=([^&]+)/.exec(a),i=/postGoto=([^&]+)/.exec(a);if(o){var n=decodeURIComponent(o[1]);n.match(/^https?\:\/\//)||(n="http://"+n),startLoading(),defineMensagem("sucesso","Redirecionando..."),setTimeout(function(){window.location=n},50)}else if(i){n=decodeURIComponent(i[1]);var r=n.split("?"),t=$("<form></form>").attr("method","POST").attr("action",n);if(r[1])for(var s=decodeURIComponent(r[1]).split("&"),c=0;c<s.length;++c){var l=s[c].split("=");t.append($("<input></input>").attr("type","hidden").attr("name",l[0]).attr("value",l[1]))}$("body").append(t),t.submit()}}var baseURL=window.location.protocol+"//"+window.location.host,baseURLOpenAM=baseURL+"/openam",getLoginCooperado=function(){var e=$("#usuario").val();return getLoginUsuarioCooperado(e)},getUsuarioSolicitante=function(){return $("#usuario-solicitante").val()},getUsuarioSolicitanteCliente=function(){return $("#usuario").val()},getUsuarioSolicitanteCooperado=function(){var e=$("#usuario-solicitante-cooperado").val();return getLoginUsuarioCooperado(e)},getEmailSolicitante=function(){return $("#email-solicitante").val()},getEmailCliente=function(){return $("#email-cliente").val()};